# Detection
---
- **==Note:- PowerUp.ps1 does not find this==**
- Find **permission to Startup directory** using `icacls.exe`:
	- `icacls.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"`
	- We are looking for "BUILTIN\USERS : <\F>", Here "F" means full access. 
	- ![[Pasted image 20250417163953.png]]
- From Microsoft Docs: [https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/icacls]
	- ![[Pasted image 20250417164100.png]]

# Exploitation
---
- **We can transfer the reverse shell binary** from `msfvenom`to `startup`folder **after starting the `msfconsole`listener.**
	- ==Note:- We cannot transfer `x.exe` (adds `user`user to admin group) as it requires prompt from logged in user, while reverse shell runs automatically.==
- Download to : `C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup`
	- ==Note:- Downloading some place else and copying might not work, download directly to Startup folder==
	- ![[Pasted image 20250417165220.png]]
- Setup Listener:
  ![[Pasted image 20250417164723.png]]
- Logout and login as administrator ("TCM" here) user:
	- ![[Pasted image 20250417165407.png]]